<!DOCTYPE html>
<html>
  <head>
    <title>Porybox</title>

    <!-- Viewport mobile tag for sensible mobile support -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="<%= sails.config.environment === 'development' ? '/bundle.css' : '/bundle.min.css' %>" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
  </head>

  <body flex layout="column" ng-controller="MainCtrl as main" ng-cloak layout-fill
    ng-init="main.init({
      boxes: <%=(typeof boxes !== 'undefined' ? JSON.stringify(boxes) : '[]')%>,
      user: <%=(typeof user !== 'undefined' ? JSON.stringify(user) : 'null')%>,
      prefs: <%=(typeof prefs !== 'undefined' ? JSON.stringify(prefs) : '{}')%>
    })">
    <div id="scroll-container">
      <%- include header.ejs %>
      <div flex layout="column">
        <main flex="none">
          <%- body %>
          <% if (user == null && url === '/') { %>
            <!-- Render the landing page without angular to distract people with static content while the bundle downloads -->
            <div id="landing-page" style="display:none;" ng-if="location.hash === '' || location.hash === '#/'">
              <% include home/index.view.html %>
            <div>
            <script>if (location.hash === '' || location.hash === '#/') document.getElementById('landing-page').style.display = '';</script>
          <% } %>
        </main>
        <div flex></div>
        <%- include footer.ejs %>
      </div>
    </div>
    <div id="csrf-token"><%= typeof _csrf !== undefined ? _csrf : '' %></div>
    <script src="<%= sails.config.environment === 'development' ? '/bundle.js' : '/bundle.min.js' %>"></script>
  </body>
</html>
